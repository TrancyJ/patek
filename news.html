<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Patek Philippe SA | 新闻</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
	<link rel="stylesheet" href="css/header.css">
	<link rel="stylesheet" href="css/PatekGrid.css">
	<link rel="stylesheet" href="css/footer.css">
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/news.css">
	<link rel="stylesheet" href="font/iconfont/iconfont.css">
	<script src="js/jquery.js"></script>
</head>
<body>
<!-- 	头部引入 -->
	<div id="header"></div>
	<section class="section-content">
<!-- 	面包屑导航 -->
	<div class="breadcrumb_wrapper clearfix">
		<ul class="breadcrumb_list clearfix">
			<li>百达翡丽 &nbsp;&nbsp;&nbsp;&gt;</li>
			<li>&nbsp;&nbsp;&nbsp;&nbsp; 新闻</li>
		</ul>
	</div>
	
<!-- 	轮播大图 -->
	<div class="banner_bg">
		<div class="banner_text">
			<h1>百达翡丽从 1839 年创立至今的发展历史...</h1>
		</div>
		<p class="p_subscribe">[ <span class="news_subscribe">订阅新闻通讯</span> ]</p>
	</div>

	<!-- 		订阅新闻通讯 -->
	<iframe class="subscribe collapsed" scrolling="no" src="subscribe.html" width="70%" frameborder="0"></iframe>

<!-- 	主体内容 -->
	<div class="main">

		<div class="filter">

			<!-- 过滤选择 -->
			<div class="drop-down">
				<div class="input_select">
					<input type="text" value="所有年份" readonly>
					<i class="iconfont icon-arrowdown"></i>
				</div>
				<ul class="inputYears_options">
					<li class="selected">所有年份</li>
					<li>2017</li>
					<li>2016</li>
					<li>2014</li>
				</ul>
			</div>
			<div class="drop-down">
				<div class="input_select">
					<input type="text" value="所有月份" readonly>
					<i class="iconfont icon-arrowdown"></i>
				</div>
				<ul class="inputMonths_options" >
					<li class="selected">所有月份</li>
					<li data-month="3">三月</li>
					<li data-month="6">六月</li>
					<li data-month="8">八月</li>
					<li data-month="9">九月</li>
					<li data-month="11">十一月</li>
				</ul>
			</div>
			<i class="iconfont icon-i-close news_close"></i>
		</div>

		<section class="watch_wrapper clearfix">
			<section class="year clearfix" data-year="2017" data-months="3,6,11">
				<header>2017</header>
				<section class="watch_thumbnail" data-month="11">
					<h3>十一月 2017</h3>
					<a href="#"><img src="img/news/2017_11_1.jpg"></a>
					<h2>ONLY WATCH 2017 / GENEVA – AUCTION RESULTS</h2>
					<p>The 7th Only Watch auction took place in Geneva on Saturday, November 11, 2017</p>
				</section>
				<div class="col_xs line"></div>
				<section class="watch_thumbnail" data-month="11">
					<h3>十一月 2017</h3>
					<a href="#"><img src="img/news/2017_11_2.jpg"></a>
					<h2>百达翡丽 AQUANAUT REF. 5168G</h2>
					<p>為廿載當代悠閒時尚加冕</p>
				</section>
				<div class="col_xs line"></div>
				<div class="col_sm line"></div>
				<section class="watch_thumbnail" data-month="6">
					<h3>六月 2017</h3>
					<a href="#"><img src="img/news/2017_6.jpg"></a>
					<h2>THE ART OF WATCHES GRAND EXHIBITION NEW YORK 2017</h2>
					<p>Patek Philippe is delighted to present The Art of Watches, Grand Exhibition New York 2017 which will (...)</p>
				</section>
				<div class="col_xs line"></div>
				<div class="col_md line"></div>
				<section class="watch_thumbnail" data-month="3">
					<h3>三月 2017</h3>
					<a href="#"><img src="img/news/2017_3_1.jpg"></a>
					<h2>BASELWORLD 2017</h2>
					<p>Take a look at the exciting timepieces being unveiled to the press on March 22th 2017 at Baselworld. (...)</p>
				</section>
				<div class="col_xs line"></div>
				<div class="col_sm line"></div>
				<section class="watch_thumbnail" data-month="3">
					<h3>三月 2017</h3>
					<a href="#"><img src="img/news/2017_3_2.jpg"></a>
					<h2>2017年新款|百达翡丽新款</h2>
					<p>全新系列亮相2017年巴塞尔国际钟表珠宝展，以多款新品扩充现有常规腕表系列，其中包括一款全新的万年历腕表、一款庆祝Aquanaut系列诞生20周年的全新腕表，以及多款经典的全新演绎，令高级制表工艺鉴赏 (...)</p>
				</section>
				<div class="col_xs line"></div>
				<section class="watch_thumbnail" data-month="3">
					<h3>三月 2017</h3>
					<a href="#"><img src="img/news/2017_3_3.jpg"></a>
					<h2>PATEK PHILIPPE ADVANCED RESEARCH AQUANAUT TRAVEL TIME REF. 5650G</h2>
					<p>Patek Philippe Advanced Research opens up a further chapter with the launch of two important (...)</p>
				</section>
			</section>

			<section class="year clearfix" data-year="2016" data-months="8,9,11">
				<header>2016</header>
				<section class="watch_thumbnail" data-month="11">
					<h3>十一月 2016</h3>
					<a href="#"><img src="img/news/2016_11.jpg"></a>
					<h2>《PATEK PHILIPPE: THE AUTHORIZED BIOGRAPHY》，作者：尼克•福克斯</h2>
					<p>我们非常荣幸地宣布,《Patek Philippe: The Authorized (...)</p>
				</section>
				<div class="col_xs line"></div>
				<section class="watch_thumbnail" data-month="9">
					<h3>九月 2016</h3>
					<a href="#"><img src="img/news/2016_9.jpg"></a>
					<h2>百达翡丽NAUTILUS系列诞生四十周年</h2>
					<p>2016年，百达翡丽庆祝休闲优雅的Nautilus运动腕表系列诞生四十周年。对于许多经典制表工艺杰作的爱好者与收藏家而言，这是一个值得纪念的时刻。回顾这段始于1976年的传奇，不仅让我们了解到整个世界 (...)</p>
				</section>
				<div class="col_xs line"></div>
				<div class="col_sm line"></div>
				<section class="watch_thumbnail" data-month="8">
					<h3>八月 2016</h3>
					<a href="#"><img src="img/news/2016_8.jpg"></a>
					<h2>百达翡丽CALATRAVA REF. 7200/200R</h2>
					<p>随着Calatrava Ref. (...)</p>
				</section>
			</section>

			<section class="year clearfix" data-year="2014" data-months="6">
				<header>2014</header>
				<section class="watch_thumbnail" data-month="6">
					<h3>六月 2014</h3>
					<a href="#"><img src="img/news/2014_6.jpg"></a>
					<h2>THE MAISON PATEK PHILIPPE IN CHINA</h2>
					<p>The two Maisons in Beijing and Shanghai, together with the Patek Philippe Salons in Geneva, London, (...)</p>
				</section>
			</section>
		</section>
	</div>
	</section>
<!-- 	底部引入 -->
	<div id="footer"></div>

	<script>
		window.onload = function() {
			var iframe = document.querySelector('.subscribe')
			var childDocument = iframe.contentWindow.document
			var inputs = document.querySelectorAll('.input_select')

			//隐藏iframe
			childDocument.querySelector('.subscribe_close').addEventListener('click', function() {
				iframe.className += ' collapsed'
			})
			//展开iframe
			document.querySelector('.news_subscribe').addEventListener('click', function(e) {
				// 90表示页头的高度
				var distance = iframe.offsetTop - 90
				var isCollapsed = iframe.classList.contains('collapsed')
				var isCollapsedReg = /\s*collapsed\s*/
				if (isCollapsed) {
					iframe.className = iframe.className.replace(isCollapsedReg, ' ')
					setTimeout(function() {
						window.scrollTo(0, distance)
					}, 1000)
				}
				else iframe.className += ' collapsed'
			})

			//替换类名
			var replaceClassName = function(el, newName, oldName) {
				if (arguments.length < 3) return
				//判断旧类名是否存在,若不存在直接在结尾处增加类名,如果已存在新类名,则不增加
				var reg = new RegExp('\s*'+oldName+'\s*')
				var reg_newName = new RegExp('\s*'+newName+'\s*')
				if (reg.test(el.className)) {
					el.className = el.className.replace(reg, ' '+newName+' ')
				} else if (reg_newName.test(el.className)) {
					return 
				} else {
					el.className += ' '+newName
				}
			}

			for (var i=0; i<inputs.length; i++) {
			    //点击展开下拉框
				inputs[i].onclick = function(e) {
					var ul = this.nextElementSibling
					var len = ul.children.length
					var reg_up = /icon-arrow-up/
                    ul.style.height = len*42+'px'
                    replaceClassName(this.children[1], 'icon-arrow-up', 'icon-arrowdown')
					if (reg_up.test(e.target.className)) {
					    ul.style.height = 0
                        replaceClassName(e.target, 'icon-arrowdown', 'icon-arrow-up')
                    }
				}
				//input失去焦点使下拉框回收
				inputs[i].children[0].onblur = function() {
					var self = this
					var input = this.parentElement
					var ul = input.nextElementSibling

					setTimeout(function() {
						replaceClassName(self.nextElementSibling, 'icon-arrowdown', 'icon-arrow-up')
						ul.style.height = 0
					}, 100)
					
				}
			}
			
			var clearChildrenClassName = function(el) {
				for (var i=0; i<el.children.length; i++) {
					el.children[i].className = ''
				}
			}
			//复原下拉
			var resetInputOptions = function (el) {
				;[...el.children].forEach(item => {
				    item.style = ''
				})
				clearChildrenClassName(el)
				el.children[0].className = 'selected'
            }
            //复原新闻一览
            var resetWatches = function () {
                ;[...document.querySelectorAll('.year')].forEach(item => {
                    item.style = ''
                })
                ;[...document.querySelectorAll('.watch_thumbnail')].forEach(item => {
                    item.style = ''
                })
				;[...document.querySelectorAll('.line')].forEach(item => {
				    item.style = ''
				})
            }
            //恢复隐藏指定的yearSection下的所有格式
            var resetYearSection = function(yearSection) {
                [...yearSection.children].forEach(item => {
                    item.style = ''
				})
			}
			//恢复隐藏所有yearSection下的格式
            var resetAllYearSections = function() {
                ;[...document.querySelectorAll('.watch_thumbnail')].forEach(item => {
                    item.style.display = ''
                })
                ;[...document.querySelectorAll('.line')].forEach(item => {
                    item.style.display = ''
                })
			}
			
			var input_onchange = function(e) {
				var tar = e.target
				var reg = /\s*selected\s*/
				var year = 0
				var month = 0
				var monthsUl = document.querySelector('.inputMonths_options')
				var yearSections = document.querySelectorAll('.year')
                var months = [3, 6, 8, 9, 11]
				//数组表示需要隐藏的下标
				var watches = {
					2017: {
						11: [2, 3, 4, 5],
						6: [0, 1, 3, 4, 5],
						3: [0, 1, 2]
					},
					2016: {
						11: [1, 2],
						9: [0, 2],
						8: [0, 1]
					},
					2014:{
						6: []
					}
				}
				
                if (this.className === 'inputYears_options') {
                    //恢复隐藏的月份下拉选择框
					[...monthsUl.children].forEach(function(item) {
						item.style = ''
					})
                }
                //恢复隐藏的年份
                ;[...yearSections].forEach(function(item) {
                    item.style = ''
                })
				
				//改值, 如果不改变则不进行下面的步骤
				if (!reg.test(tar.className)) {
					clearChildrenClassName(this)
					tar.className += ' selected'
					this.previousElementSibling.children[0].value = tar.innerText
				} else {
					return 
				}

				//级联, 过滤
				//如果年份读取年份值且隐藏不满足月份的下拉菜单, 月份读取月份值
				//隐藏不满足的年份和月份
				if (this.className === 'inputYears_options') {
				    resetInputOptions(monthsUl)
					monthsUl.previousElementSibling.children[0].value = '所有月份'
					parseInt(tar.innerText) && (year = +tar.innerText)
					if (year !== 0) {
                        resetAllYearSections()
						var keys = Object.keys(watches[year]).map(item => +item)
						var hideMonth = months.filter(function(item) {
							return keys.indexOf(item) < 0
						})
						//隐藏月份的下拉菜单
						for (var i=1; i<=months.length; i++) {
                            hideMonth.forEach(function(item) {
								if (item === +monthsUl.children[i].dataset.month) {
									monthsUl.children[i].style.display = 'none'
								}
							})
						}
						//隐藏一览页的年份
                        ;[...yearSections].forEach(item => {
                            if (year !== +item.dataset.year) item.style.display = 'none'
                        })
					}  else { //恢复隐藏的月份
                        resetAllYearSections()
					}
//					点击months下拉选项 过滤
				} else {
					tar.dataset.month && (month = +tar.dataset.month)
                    year = document.querySelector('.inputYears_options')
                        .previousElementSibling.children[0].value
                    year = parseInt(year) ? +year : 0
                    if (month !== 0) {
						;[...document.querySelectorAll('.watch_thumbnail')].forEach(item => {
						    item.style = ''
						})
						;[...document.querySelectorAll('.line')].forEach(item => {
						    item.style.display = 'none'
						})
						//指定年份里过滤
						if (year !== 0) {
							for (var i=0; i<yearSections.length; i++) {
                                if (year===+yearSections[i].dataset.year) {
                                    var year_watches = [...yearSections[i].children].filter(item => item.className==='watch_thumbnail')
									year_watches.forEach((item, index) => {
                                        if (watches[year][month].indexOf(index)!==-1) item.style.display = 'none'
									})
                                } else {
                                    yearSections[i].style.display = 'none'
								}
							}
                        } else { //所有年份里过滤
                            ;[...yearSections].forEach(item => {
                                //找到不包含该月份的年,全部隐藏
                                if (item.dataset.months.indexOf(month)===-1) {
                                    item.style.display = 'none'
								} else {  //找到包含该月份的年,隐藏其他月份
                                    ;[...item.children].forEach(watch => {
                                        if (watch.className==='watch_thumbnail'
											&& +watch.dataset.month!==month)
                                            watch.style.display = 'none'
                                    })
                                }
                            })
							
                        }
						
                    } else { //点击选择所有所有隐藏
                       if (year===0) resetWatches()
					   else { //隐藏不满足的年
                           ;[...yearSections].forEach(item => {
                               //找到不为year的年,全部隐藏
                               if (+item.dataset.year!==year) {
                                   item.style.display = 'none'
                               } else {
                                   resetYearSection(item)
							   }
                           })
					   }
					}
				}
			}
			
			//模拟input的onchange事件,改变input值,过滤
			document.querySelector('.inputYears_options').onclick = input_onchange
			document.querySelector('.inputMonths_options').onclick = input_onchange
			//reset input的值
			document.querySelector('.news_close').onclick = function() {
				var years = document.querySelector('.inputYears_options')
				var months = document.querySelector('.inputMonths_options')
                resetInputOptions(years)
                resetInputOptions(months)
				years.previousElementSibling.children[0].value
					= years.children[0].innerHTML
				months.previousElementSibling.children[0].value
					= months.children[0].innerHTML
				resetWatches()
			}
		}
		
	</script>
<script src="js/loadheader.js"></script>
</body>
</html>